<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#1a1a1a">
    <title>TayDot Player - Modern Audio Experience</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary: #ff6b6b;
            --secondary: #1a1a1a;
            --text: #ffffff;
            --surface: rgba(40, 40, 40, 0.95);
            --spacing-base: 1rem;
            --radius-lg: 1.5rem;
            --transition-timing: cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Modern CSS Reset */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
            font-size: 16px;
            background: linear-gradient(135deg, var(--secondary), #2a2a2a) fixed;
            color: var(--text);
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
        }

        @supports (font-variation-settings: normal) {
            html { font-family: 'Inter var', system-ui; }
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            border: 0;
        }

        .player-container {
            --player-padding: var(--spacing-base);
            position: fixed;
            inset: 0;
            display: grid;
            place-items: center;
            background: rgba(0 0 0 / 0.9);
            backdrop-filter: blur(10px);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.5s var(--transition-timing),
                        visibility 0.5s var(--transition-timing);
            z-index: 1000;
        }

        .player-container[data-visible="true"] {
            opacity: 1;
            visibility: visible;
        }

        .player-content {
            display: grid;
            gap: var(--spacing-base);
            background: var(--surface);
            border-radius: var(--radius-lg);
            padding: var(--spacing-base);
            width: min(90vw, 600px);
            transform: scale(0.9);
            transition: transform 0.3s var(--transition-timing);
        }

        .visualizer {
            position: relative;
            height: 300px;
            border-radius: var(--radius-lg);
            overflow: hidden;
            isolation: isolate;
        }

        .visualizer::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, var(--surface), transparent 60%);
        }

        canvas {
            width: 100%;
            height: 100%;
        }

        /* Advanced Controls */
        .advanced-controls {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--spacing-base);
        }

        .equalizer-preset {
            --thumb-size: 1.25rem;
            appearance: none;
            background: transparent;
            cursor: pointer;
        }

        .equalizer-preset::-webkit-slider-runnable-track {
            height: 4px;
            background: rgba(255 255 255 / 0.1);
            border-radius: 2px;
        }

        .equalizer-preset::-webkit-slider-thumb {
            appearance: none;
            width: var(--thumb-size);
            height: var(--thumb-size);
            background: var(--primary);
            border-radius: 50%;
            margin-top: calc((4px - var(--thumb-size)) / 2);
        }
    </style>
</head>
<body>
    <!-- Simplified Semantic HTML Structure -->
    <main class="container">
        <header class="header">
            <h1>TayDot Player</h1>
            <button class="upload-btn" aria-label="Add songs">
                <i class="fas fa-plus" aria-hidden="true"></i>
                <span>Add Songs</span>
            </button>
        </header>

        <section class="playlist" aria-label="Music playlist">
            <!-- Dynamic playlist items -->
        </section>

        <dialog class="player-container" aria-labelledby="playerHeading">
            <div class="player-content">
                <button class="back-btn" aria-label="Close player">
                    <i class="fas fa-arrow-left" aria-hidden="true"></i>
                </button>
                
                <section class="visualizer">
                    <canvas id="audioVisualizer"></canvas>
                </section>

                <div class="advanced-controls">
                    <input type="range" class="equalizer-preset" id="bass" min="-40" max="40" step="1">
                    <input type="range" class="equalizer-preset" id="mid" min="-40" max="40" step="1">
                    <input type="range" class="equalizer-preset" id="treble" min="-40" max="40" step="1">
                </div>
            </div>
        </dialog>
    </main>

    <script type="module">
        // Modern JavaScript Features
        class AudioPlayer {
            #audioContext;
            #analyserNode;
            #currentTrack = 0;
            #isPlaying = false;

            constructor() {
                this.initWebAudio();
                this.registerServiceWorker();
                this.setupEventListeners();
                this.setupIntersectionObserver();
                this.setupMediaSession();
            }

            initWebAudio() {
                this.#audioContext = new (window.AudioContext || window.webkitAudioContext)();
                this.#analyserNode = this.#audioContext.createAnalyser();
                this.#analyserNode.fftSize = 256;
            }

            async setupMediaSession() {
                if ('mediaSession' in navigator) {
                    navigator.mediaSession.setPositionState({
                        duration: 0,
                        playbackRate: 1,
                        position: 0
                    });
                }
            }

            visualizeAudio() {
                const bufferLength = this.#analyserNode.frequencyBinCount;
                const dataArray = new Uint8Array(bufferLength);
                const canvas = document.getElementById('audioVisualizer');
                const ctx = canvas.getContext('2d');

                const draw = () => {
                    requestAnimationFrame(draw);
                    this.#analyserNode.getByteFrequencyData(dataArray);
                    
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    // Add visualization implementation
                };

                draw();
            }

            // Remaining class implementation...
        }

        // Progressive Enhancement
        if ('mediaSession' in navigator && 'AudioContext' in window) {
            const player = new AudioPlayer();
        } else {
            document.body.innerHTML = `
                <div class="browser-warning">
                    <h2>Unsupported Browser</h2>
                    <p>Please update to a modern browser for full functionality</p>
                </div>
            `;
        }
    </script>
</body>
</html>
